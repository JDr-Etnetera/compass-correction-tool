<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="_?,(_{t66z+us546Eb(/">compass</variable><variable id="O:ETVS!#kKz88JXm`.gR">direction</variable><variable id="XU|i8VF~Sv@J?6%[^]{,">rotationTime</variable><variable id="cD8tiZ{WPEUr^OK=b0XI">ANGULAR_SPD</variable><variable id="glNF_O=)PhEJN]_YT|2x">LEFT_ROTATION_SPD_MAX</variable><variable id="F4,B#BO%:(iTUsa/n#U)">RIGHT_ROTATION_SPD_MAX</variable><variable id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</variable><variable id="=S_s5hviA*1eMKUyoXp*">rightSpeed</variable><variable id="YFOiGtP[Py!0r|0vd$6#">SERIAL_LOGGING</variable><variable id="`:y9ebc{-+($Ae*8/{Y-">tmp</variable><variable id="O,P;a!Mg,!VrE!)ddkV7">delta</variable><variable id="POit$ri$1J|c7EiiuSrs">i</variable><variable id="q?f/R:})F^~M7@yT}AC;">COMPASS_TICK</variable><variable id="_Cg[eA)XQI#brfvpz[36">COMPASS_HISTORY</variable></variables><block type="function_call" id="oQe9=uMS|n_,s14/Kw7f" disabled="true" x="970" y="-318"><mutation name="compassTick" functionid="KAPfS9OU(KeVL7m2L1Ud"><arg name="angle" id="pk068pbipq2nnn99xu0p3" type="number"/></mutation><value name="pk068pbipq2nnn99xu0p3"><shadow type="math_number" id="h(4sd%Q6NJn10jY/w|Xq" disabled="true"><field name="NUM">1</field></shadow></value><next><block type="function_call" id="}`|;@7G*CGUSn+]T]/RI" disabled="true"><mutation name="debugCorrection" functionid="ar5;T[eXw]!UtymPR.iU"/><next><block type="function_call" id="%LS=GiGolXZDs+u1sI7!" disabled="true"><mutation name="compassDelta" functionid="?L;yZyFyrFSlK$foxHPs"/></block></next></block></next></block><block type="every_interval" id="ZU/W8_|s~pA:F|b^O5{h" x="717" y="-212"><value name="interval"><shadow type="longTimePicker" id="b0fJm3pm~wg=WslD;f`7"><field name="ms">500</field></shadow></value></block><block type="every_interval" id="9kLEE{`luDR*ebc}eiM!" x="1152" y="-171"><value name="interval"><shadow type="longTimePicker" id=".)9mlygK^_8kf6-?:B`h"><field name="ms">5000</field></shadow></value></block><block type="controls_if" id="T[9UEt{-HGIJh}U.t8}U" disabled="true" x="1397" y="-140"><mutation else="1"/><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="qd2S5j0I.1X42f7a#pAR" disabled="true"><field name="OP">GT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="g2(LhFdj`1u,OiH@8T3B" disabled="true"><field name="VAR" id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</field></block></value><value name="B"><shadow type="math_number" id="l/C-NANsT*5Kg0fv;+e6" disabled="true"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="variables_set" id="Rac?1^dHKm`W(1ngIt6M" disabled="true"><field name="VAR" id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</field><value name="VALUE"><shadow type="math_number" id="1[~~3ZrPCDkQ#RAU~j@7" disabled="true"><field name="NUM">0</field></shadow></value><next><block type="ringbitcar_brake" id="T(s-s~[otG$#c@uDFz(?" disabled="true"/></next></block></statement><statement name="ELSE"><block type="variables_set" id="CMN?-Zc5}e|QUuqvoe!C" disabled="true"><field name="VAR" id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</field><value name="VALUE"><shadow type="math_number" id="~ET@@]z8$=m%~j[B($^%" disabled="true"><field name="NUM">50</field></shadow></value><next><block type="ringbitcar_freestyle" id="Tgh4:x9NFE`^06iUbHaz" disabled="true"><value name="m"><shadow type="math_number_minmax"><mutation min="-100" max="100" label="M" precision="0"/><field name="SLIDER">50</field></shadow><block type="variables_get" id="%$}BqBE=ZaODYD#zEcJm" disabled="true"><field name="VAR" id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</field></block></value><value name="n"><shadow type="math_number_minmax" id="_nj;{3WindIDh+@sbnnF" disabled="true"><mutation min="-100" max="100" label="N" precision="0"/><field name="SLIDER">0</field></shadow></value></block></next></block></statement></block><block type="pxt-on-start" id="r80dB5/|@i:8jB1:z^+_" x="0" y="0"><statement name="HANDLER"><block type="variables_set" id="8Ib]PWJz}E.#qX,kN(@u"><field name="VAR" id="YFOiGtP[Py!0r|0vd$6#">SERIAL_LOGGING</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="logic_boolean" id="`q-$;tY9Sjnh)UL#yuo0"><field name="BOOL">TRUE</field></block></value><next><block type="variables_set" id="m4UzRHTO.E2IpB_%b2WA"><field name="VAR" id="cD8tiZ{WPEUr^OK=b0XI">ANGULAR_SPD</field><comment pinned="false" h="80" w="160" relx="10" rely="10">Turning speed of car [deg per ms]</comment><value name="VALUE"><shadow type="math_number" id="Dbn!M)s$uPXK?|J(}*%|"><field name="NUM">0.015</field></shadow></value><next><block type="variables_set" id="IF{9JBBtz9A!;%y*yd=m"><field name="VAR" id="q?f/R:})F^~M7@yT}AC;">COMPASS_TICK</field><comment pinned="false" h="80" w="160" relx="10" rely="10">time between gathering compass data</comment><value name="VALUE"><shadow type="math_number" id="Zw?qJxD@N^=%Hfm5GFMV"><field name="NUM">20</field></shadow></value><next><block type="variables_set" id="+n?|}[OxL(dc}Y!?|b3?"><field name="VAR" id="_Cg[eA)XQI#brfvpz[36">COMPASS_HISTORY</field><comment pinned="false" h="80" w="160" relx="10" rely="10">How large compass history is gathered</comment><value name="VALUE"><shadow type="math_number" id="!$x1x)p`8aE|r/AJlX;A"><field name="NUM">100</field></shadow></value><next><block type="variables_set" id="l5EU~7}!IXaX1H/EYAy["><field name="VAR" id="glNF_O=)PhEJN]_YT|2x">LEFT_ROTATION_SPD_MAX</field><comment pinned="false" h="80" w="160" relx="10" rely="10">Maximal speed of left wheel while rotating car</comment><value name="VALUE"><shadow type="math_number" id="P@VZS3C_E9E$6nE-REKC"><field name="NUM">75</field></shadow></value><next><block type="variables_set" id="y-C%UAPyM3E,VT}DPID:"><field name="VAR" id="F4,B#BO%:(iTUsa/n#U)">RIGHT_ROTATION_SPD_MAX</field><comment pinned="false" h="80" w="160" relx="10" rely="10">Maximal speed of right wheel while rotating car</comment><value name="VALUE"><shadow type="math_number" id="|(pF;x]u}?/NC#hG$K*y"><field name="NUM">-75</field></shadow></value><next><block type="ringbitcar_init" id="9C%w7V:Bvyi|g[:YrjWt"><field name="left">AnalogPin.P1</field><field name="right">AnalogPin.P2</field><next><block type="typescript_statement" id="f9**Y:+vxXjF6`9[h,g:" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let tmp: number;" numlines="1" declaredvars="tmp"></mutation><next><block type="variables_set" id=":8u=/*+/.oU3:=V/x!C]"><field name="VAR" id="`:y9ebc{-+($Ae*8/{Y-">tmp</field><value name="VALUE"><shadow type="math_number" id=")$0VR=r|0cC8S@ERTROX"><field name="NUM">-100</field></shadow></value><next><block type="typescript_statement" id="^QI330mLk[]Qudm1GiQw" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let compass: number;" numlines="1" declaredvars="compass"></mutation><next><block type="variables_set" id="WxyNE8Chqm-^F{^L2?Oy"><field name="VAR" id="_?,(_{t66z+us546Eb(/">compass</field><value name="VALUE"><shadow type="math_number" id="$|^}9]CRKbBX*.,dkosD"><field name="NUM">0</field></shadow></value><next><block type="typescript_statement" id="+NabN98=rl^Y!,rBdWy(" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let delta: number;" numlines="1" declaredvars="delta"></mutation><next><block type="variables_set" id="e[27b`bN/hzvoxXKw@,$"><field name="VAR" id="O,P;a!Mg,!VrE!)ddkV7">delta</field><value name="VALUE"><shadow type="math_number" id="@6b:SjTk`rHLy~G|nl6N"><field name="NUM">0</field></shadow></value><next><block type="typescript_statement" id="^Ds},,due[2caPc(13}V" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="class CorrectionMap {" line1="    private maxKeys: number;" line2="    private maxEntities: number;" line3="    private map: number[][]; // angle index &amp; values count" line4="    private angleList: number[];" line5="    /**" line6="     * @keys        max number of different angles" line7="     * @entities    max number of all records" line8="     */" line9="    constructor(keys: number, entities: number) {        " line10="        this.maxKeys = keys; //unused right now" line11="        this.maxEntities = entities;        " line12="        this.reset();" line13="    }" line14="    private isNewAngle(angle: number) {" line15="        return (this.angleList.indexOf(angle) &lt; 0)" line16="    }" line17="    /**" line18="     * Adds angle to history" line19="     */" line20="    addAngle(angle: number) {        " line21="        if (this.isNewAngle(angle)) {" line22="            this.map[angle] = [];" line23="            this.map[angle][0] = 0;" line24="            this.angleList.push(angle);" line25="        }" line26="        this.map[angle][0] = this.map[angle][0] + 1;" line27="    }" line28="    private xxx(item: number[], index: number) {" line29="" line30="    }" line31="    /**" line32="     * Removes angle from history" line33="     */" line34="    removeAngle(angle: number) {" line35="        console.log(&quot;removeAngle(&quot;+angle+&quot;)&quot;)" line36="        if (this.isNewAngle(angle)) {" line37="            console.log(&quot;remAngle&gt; new angle - this should not happen&quot;)" line38="            return false;" line39="        }            " line40="" line41="        console.log(&quot;remAngle(&quot;+ angle +&quot;)&gt; subtrackt angle&quot;);" line42="        this.map[angle][0] = this.map[angle][0] - 1;" line43="        try {    " line44="            if (this.map[angle][0] == 0) {" line45="                console.log(&quot;remAngle&gt; final cleanup&quot;);" line46="                //this.map.splice(angle-1, 1)" line47="                /*this.map.forEach(function (value: number[], index: number) {" line48="                    tmp = NaN;" line49="                    if ( (!! this.map[index]) &amp;&amp; this.map[index][0] !== NaN) {" line50="                        tmp = this.map[index][0]" line51="                    }" line52="                    console.log(&quot;check&gt; [&quot; + index + &quot;]:&quot; + (isNaN(tmp) ? &quot;&quot; : tmp))" line53="                })*/" line54="            }" line55="        } catch (error) {" line56="            console.log(error)" line57="        }" line58="        return true;" line59="    }" line60="    /**" line61="     * Deletes all records of given angle" line62="     */" line63="    removeAngleHistory(angle: number) {" line64="        this.map[angle][0] = 0;" line65="    }" line66="    /**" line67="     * Deletes all records collected" line68="     */" line69="    reset() {" line70="        this.map = [];" line71="        this.angleList = [];" line72="    }" line73="    getAll() {" line74="        return this.map;" line75="    }" line76="    /**" line77="     * Returns list of collected angles" line78="     */" line79="    getKnownAngles() {" line80="        return this.angleList;" line81="    }" line82="}" numlines="83"></mutation><next><block type="typescript_statement" id="4(l*a%49|TQc~3mmbA6N" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="class CompassHistory {" line1="    private maxEntries: number;" line2="    private compassTick: number;" line3="    private callibrationTime: number;" line4="    private history: number[];" line5="    private correction: CorrectionMap;" line6="    /**" line7="     * @max compass calibration history length" line8="     * @tick how long wait before repeating reading from compass [ms]" line9="     */" line10="    constructor(max: number, tick: number) {        " line11="        this.history = [];" line12="        this.maxEntries = max;" line13="        this.compassTick = tick;" line14="        this.callibrationTime = max * tick;" line15="        this.correction = new CorrectionMap(10, 20);" line16="    }" line17="    /**" line18="     * Adds angle to history tracking" line19="     */" line20="    append(angle: number) {" line21="        logValue(&quot;c&quot;, angle)" line22="        if (this.history.length == this.maxEntries) {" line23="            this.correction.removeAngle(this.history[0]);" line24="            this.history.splice(0, this.history.length - this.maxEntries +1);                        " line25="        }" line26="        this.history.push(angle);" line27="        this.correction.addAngle(angle);" line28="    }" line29="    /**" line30="     * Returns angle with correction" line31="     * @dec number of decimal places" line32="     */" line33="    getDelta(dec: number) {" line34="        if (this.getLength() &lt; 1) return -100;" line35="        let sum = 0;" line36="        this.history.forEach(function (e) {" line37="            sum += e;" line38="        });" line39="        let delta2 = Math.round( (sum * Math.pow(10, dec)) / this.getLength() ) / Math.pow(10, dec);" line40="        logValue(&quot;d&quot;, delta2)" line41="        return delta2;" line42="    }" line43="    fullCalibration() {" line44="        this.reset()" line45="        for (let j = 0; j &lt; this.maxEntries; j++) {" line46="            this.append(input.compassHeading())" line47="            basic.pause(this.compassTick)" line48="        }" line49="    }" line50="    getFromRow() {" line51="        if (this.history.length &gt; 0) {" line52="            return this.history.slice(0,1);" line53="        }" line54="        return -100;" line55="    }" line56="    getLength() {" line57="        return this.history.length;" line58="    }" line59="    reset() {" line60="        this.history = [];" line61="        this.correction.reset();" line62="    }" line63="    getHistory() {" line64="        return this.history" line65="    }" line66="    getCorrection() {" line67="        return this.correction.getAll();" line68="    }" line69="    getKnownAngles() {" line70="        return this.correction.getKnownAngles();" line71="    }" line72="}" numlines="73"></mutation><next><block type="typescript_statement" id="(^A_KkqgXFZfMtcfpN1Q" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let cHistory = new CompassHistory(COMPASS_HISTORY, COMPASS_TICK);" numlines="1" declaredvars="cHistory"></mutation></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="function_definition" id="^d*R8;[=Xjw*HTu11h)X" x="809" y="191"><mutation name="compassTick" functionid="KAPfS9OU(KeVL7m2L1Ud"><arg name="angle" id="pk068pbipq2nnn99xu0p3" type="number"/></mutation><field name="function_name">compassTick</field><value name="pk068pbipq2nnn99xu0p3"><shadow type="argument_reporter_number" id="~^I4+o8QvB,XZ^ehs)a4"><field name="VALUE">angle</field></shadow></value><statement name="STACK"><block type="variables_set" id="gCG!IaI)-)z$3cy?Lt/?"><field name="VAR" id="_?,(_{t66z+us546Eb(/">compass</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="Q6jmL^T6v9)xC#-8~US6"><field name="VALUE">angle</field></block></value><next><block type="function_call" id="K[$)~~T7.|m$Bt|jIzJ$"><mutation name="append_ComHis" functionid="OH^=Or:/2E8@=0m%mk@w"><arg name="value" id="4blgtbdioe5u53aue8qme" type="number"/></mutation><value name="4blgtbdioe5u53aue8qme"><shadow type="math_number" id="0E6l(L9Q/=FO.?tSuj!t"><field name="NUM">1</field></shadow><block type="variables_get" id=")tBL4a#.xKb.txtydfxe"><field name="VAR" id="_?,(_{t66z+us546Eb(/">compass</field></block></value><next><block type="function_call" id="[(/g4~ZHJ@2;p]Z*cD7B"><mutation name="logValue" functionid="$!MtomJ^3CCfm6AP)-!^"><arg name="key" id="5410wkzzub0ws1zewafqk" type="string"/><arg name="value" id="iaqxz01soz55h213dtj" type="number"/></mutation><value name="5410wkzzub0ws1zewafqk"><shadow type="text" id="2|S^xA3yI~Y[=oH,OuL}"><field name="TEXT">c</field></shadow></value><value name="iaqxz01soz55h213dtj"><shadow type="math_number" id="qaG)uKKY/:JwILiMnYs]"><field name="NUM">1</field></shadow><block type="variables_get" id="oTj.;)CxR{M@_e%tEx^="><field name="VAR" id="_?,(_{t66z+us546Eb(/">compass</field></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="tB,!5)Tfl5om@E#vk)z7" x="1265" y="252"><mutation name="logValue" functionid="$!MtomJ^3CCfm6AP)-!^"><arg name="key" id="5410wkzzub0ws1zewafqk" type="string"/><arg name="value" id="iaqxz01soz55h213dtj" type="number"/></mutation><field name="function_name">logValue</field><value name="5410wkzzub0ws1zewafqk"><shadow type="argument_reporter_string" id="rAMjV;X;N8V?|,_G?SD`"><field name="VALUE">key</field></shadow></value><value name="iaqxz01soz55h213dtj"><shadow type="argument_reporter_number" id="Fi@[2KW.:uBH)q(rp?!y"><field name="VALUE">value</field></shadow></value><statement name="STACK"><block type="controls_if" id="}wVNi)*dbtydKg*O0.~v"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="variables_get" id="*R;aXfP6RPL{4/Bc78E$"><field name="VAR" id="YFOiGtP[Py!0r|0vd$6#">SERIAL_LOGGING</field></block></value><statement name="DO0"><block type="serial_writevalue" id=":oXvihQ%(@8A.Jn`I4Gs"><value name="name"><block type="argument_reporter_string" id="7;2X^{x5yz8kRhn!WWM9"><field name="VALUE">key</field></block></value><value name="value"><block type="argument_reporter_number" id="bk!-{uc9o;Qb.L73aCz@"><field name="VALUE">value</field></block></value></block></statement></block></statement></block><block type="function_definition" id="@tM;pLZ2CsQ3~rH5FX+W" x="2448" y="255"><mutation name="reset_ComHis" functionid="ayrXjG|f,v_G2n*hN!Oc"/><field name="function_name">reset_ComHis</field><statement name="STACK"><block type="typescript_statement" id="aL[k2t0dtHfO[`5rui`B" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="cHistory.reset();" numlines="1"></mutation></block></statement></block><block type="function_definition" id="-#^9eCP)V62+@mEe3hj_" x="1732" y="333"><mutation name="compassDelta" functionid="?L;yZyFyrFSlK$foxHPs"/><field name="function_name">compassDelta</field><statement name="STACK"><block type="variables_set" id="[unsxPq4Dq~|zVKeo}_T"><field name="VAR" id="`:y9ebc{-+($Ae*8/{Y-">tmp</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="function_call_output" id="rdwrw!M*`$1[BeWXBj8]"><mutation name="getDelta_ComHis" functionid="Je4+bO|]ESE9`9O48-y*"/></block></value><next><block type="controls_if" id="43xvgnhB8H`FUn[qv{bw"><mutation else="1"/><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="T]XM3[L5F!s4:NzoL)$s"><field name="OP">LT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="o=%R-Dfi}W_A!$6}C=)J"><field name="VAR" id="`:y9ebc{-+($Ae*8/{Y-">tmp</field></block></value><value name="B"><shadow type="math_number" id="nZ]!nu+wHG!$]EbZiY;v"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="serial_writestring" id="E7z=+.VX)lSSp?ar|I/,"><value name="text"><block type="text_join" id="!T]fUh}h-!|Mb9{3e5fB"><mutation items="2"/><value name="ADD0"><shadow type="text" id="N8S-%[bm`dK:.Rgnj`j8"><field name="TEXT"> ERR </field></shadow></value><value name="ADD1"><shadow type="text"><field name="TEXT"/></shadow><block type="typescript_expression" id="J7Ee0SXqgmu@:l$s-#Os" editable="false"><field name="EXPRESSION">'\n'</field></block></value></block></value></block></statement><statement name="ELSE"><block type="variables_set" id="e|9}hkgG$]G9v*g@1.pz"><field name="VAR" id="O,P;a!Mg,!VrE!)ddkV7">delta</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="@+b=z74_`Xx|2ZO?/a.P"><field name="VAR" id="`:y9ebc{-+($Ae*8/{Y-">tmp</field></block></value><next><block type="function_call" id="w4_on$zMkmvpbK#Y`zx%"><mutation name="logValue" functionid="$!MtomJ^3CCfm6AP)-!^"><arg name="key" id="5410wkzzub0ws1zewafqk" type="string"/><arg name="value" id="iaqxz01soz55h213dtj" type="number"/></mutation><value name="5410wkzzub0ws1zewafqk"><shadow type="text" id="ea4#atsm5gRkrTbV!](o"><field name="TEXT">D</field></shadow></value><value name="iaqxz01soz55h213dtj"><shadow type="math_number" id="}a`X?Gpg8MdYzOVk.NrP"><field name="NUM">1</field></shadow><block type="variables_get" id="rTgUX(sZ~6hL5#szEuP0"><field name="VAR" id="O,P;a!Mg,!VrE!)ddkV7">delta</field></block></value><next><block type="function_call" id="N$i^at$bz42Mz{[ms]BW"><mutation name="logValue" functionid="$!MtomJ^3CCfm6AP)-!^"><arg name="key" id="5410wkzzub0ws1zewafqk" type="string"/><arg name="value" id="iaqxz01soz55h213dtj" type="number"/></mutation><value name="5410wkzzub0ws1zewafqk"><shadow type="text" id="WM1yNj+|y!DCWe1w8[i8"><field name="TEXT">L</field></shadow></value><value name="iaqxz01soz55h213dtj"><shadow type="math_number" id="2Fi)MT86|j{+V3haVz?n"><field name="NUM">1</field></shadow><block type="typescript_expression" id="Y4rb_:~vGhX9liL9hfMN" editable="false"><field name="EXPRESSION">cHistory.getLength()</field></block></value></block></next></block></next></block></statement></block></next></block></statement></block><block type="function_definition" id="=:*LVtfaNn=,o*YPm}3b" x="813" y="452"><mutation name="debugCorrection" functionid="ar5;T[eXw]!UtymPR.iU"/><field name="function_name">debugCorrection</field><statement name="STACK"><block type="typescript_statement" id="bYSu+~X~F=07lQ~(/dYg" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="console.log(cHistory.getHistory())" numlines="1"></mutation><next><block type="function_call" id="G|s9kPDr[)Klz?/,(u2,"><mutation name="logValue" functionid="$!MtomJ^3CCfm6AP)-!^"><arg name="key" id="5410wkzzub0ws1zewafqk" type="string"/><arg name="value" id="iaqxz01soz55h213dtj" type="number"/></mutation><value name="5410wkzzub0ws1zewafqk"><shadow type="text" id="mm(eHd=]/4xKN}:,;UbX"><field name="TEXT">L</field></shadow></value><value name="iaqxz01soz55h213dtj"><shadow type="math_number" id="3437ZcxsR|4,jm=o-x$C"><field name="NUM">1</field></shadow><block type="typescript_expression" id="m2Z.KPcvTNI/52RhJ;3[" editable="false"><field name="EXPRESSION">cHistory.getLength()</field></block></value><next><block type="pxt_controls_for" id="W4(-booU.8TdamLk~7E3"><value name="VAR"><shadow type="variables_get_reporter" id="WCt@|*DUB0[?t:*jc`M5"><field name="VAR" id="POit$ri$1J|c7EiiuSrs">i</field></shadow></value><value name="TO"><shadow type="math_whole_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="aWHKbXRZ/%96-2hw9*}n"><field name="OP">MINUS</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_length" id="k3f2uO[@Flw$c$,-7cjP"><value name="VALUE"><block type="typescript_expression" id="UZ86/|m?eQnY-y5.10P]" editable="false"><field name="EXPRESSION">cHistory.getKnownAngles()</field></block></value></block></value><value name="B"><shadow type="math_number" id="]huDn6f=?b8Os;HRwwK~"><field name="NUM">1</field></shadow></value></block></value><statement name="DO"><block type="variables_set" id="/5Q2X!IXb6d,qnV89Ybw"><field name="VAR" id="`:y9ebc{-+($Ae*8/{Y-">tmp</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="lists_index_get" id="{y},;KHWI.R.`NWLTy+z"><value name="LIST"><block type="typescript_expression" id="?cRgKvEsK|.KuBh~bk?9" editable="false"><field name="EXPRESSION">cHistory.getKnownAngles()</field></block></value><value name="INDEX"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="d!.tlF.dTc-|1yc1)Lhx"><field name="VAR" id="POit$ri$1J|c7EiiuSrs">i</field></block></value></block></value><next><block type="typescript_statement" id="}8jb#sl^;eUm+e2_ugZ*" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="console.log(tmp +&quot; [&quot; + cHistory.getCorrection()[tmp][0] + &quot;]&quot;);" numlines="1"></mutation></block></next></block></statement></block></next></block></next></block></statement></block><block type="function_definition" id=")-kt1OV(l_ti}QEuJ02/" x="2442" y="425"><mutation name="getDelta_ComHis" functionid="Je4+bO|]ESE9`9O48-y*"/><field name="function_name">getDelta_ComHis</field><statement name="STACK"><block type="function_return" id="gYd3I{j{z(o%5twwwA_["><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="false"></mutation><value name="RETURN_VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="typescript_expression" id="k7GF}hd+x]3~.znY6JpD" editable="false"><field name="EXPRESSION">cHistory.getDelta(1)</field></block></value></block></statement></block><block type="function_definition" id="l:Uv?.d8KQT+QwcpVw)6" x="2442" y="606"><mutation name="append_ComHis" functionid="OH^=Or:/2E8@=0m%mk@w"><arg name="value" id="4blgtbdioe5u53aue8qme" type="number"/></mutation><field name="function_name">append_ComHis</field><value name="4blgtbdioe5u53aue8qme"><shadow type="argument_reporter_number" id="X+(!dQ1RnN?X%OT;dW;X"><field name="VALUE">value</field></shadow></value><statement name="STACK"><block type="typescript_statement" id="SJ.V!Qu@]tI4TPhg~[LO" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="cHistory.append(value);" numlines="1"></mutation></block></statement></block><block type="device_button_event" id="*FPKrrM/rOwy}[ZhVKzS" x="2177" y="790"><field name="NAME">Button.A</field><statement name="HANDLER"><block type="function_call" id="Fivthk^-o9CE8jEC2=?6"><mutation name="turnCar" functionid="o.xvOB%qT-]XVZ@/nZUH"><arg name="angle" id="h9kz9bsf88vo9y9assvb" type="number"/></mutation><value name="h9kz9bsf88vo9y9assvb"><shadow type="math_number" id="w1%RD!UKI5OGc%He!|uk"><field name="NUM">90</field></shadow></value></block></statement></block><block type="device_button_event" id="~}g,g19[e;IN`pF#/$va" x="2444" y="786"><field name="NAME">Button.B</field><statement name="HANDLER"><block type="function_call" id="AQTFGZ]NxnI@NcikQnTS"><mutation name="reset_ComHis" functionid="ayrXjG|f,v_G2n*hN!Oc"/></block></statement></block><block type="function_definition" id="Eb3jURD5%gJV_Y=roK4^" x="821" y="874"><mutation name="turnCar" functionid="o.xvOB%qT-]XVZ@/nZUH"><arg name="angle" id="h9kz9bsf88vo9y9assvb" type="number"/></mutation><field name="function_name">turnCar</field><value name="h9kz9bsf88vo9y9assvb"><shadow type="argument_reporter_number" id="06tIy.c3J%Wv-!Lr]8,g"><field name="VALUE">angle</field></shadow></value><statement name="STACK"><block type="typescript_statement" id="5ggk~(]G1n/q@Ba|!7q`" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="cHistory.fullCalibration();" numlines="1"></mutation><next><block type="typescript_statement" id="5%?Kd{]NpgBBY}Ix)dhf" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let startHeading = cHistory.getDelta(1);" numlines="1" declaredvars="startHeading"></mutation><next><block type="variables_set" id="z.b~Z:h+ZX2p@Xe$dVQ)"><field name="VAR" id="O:ETVS!#kKz88JXm`.gR">direction</field><value name="VALUE"><shadow type="math_number" id="pqYt!9)=59qi;F|BfQ`w"><field name="NUM">1</field></shadow></value><next><block type="controls_if" id="MA!bcjsnnxcp%3uZ!I0c"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="mt,Ziufc!GwF,%ifd((P"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="/DYmC/+,]c-QTjk?_$C#"><field name="VALUE">angle</field></block></value><value name="B"><shadow type="math_number" id="V0).%o$%0X`-Y`e/yeLb"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="function_return" id="E]h,ml:!HXx7`a?U@;tB"><mutation xmlns="http://www.w3.org/1999/xhtml" no_return_value="true"></mutation></block></statement><next><block type="controls_if" id="~aqx%2$;4,.?B}abGOXa"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="gu{C=MvXTiwb:I26+i8,"><field name="OP">LT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="kh)(!]+=#MQbXN?xM~k,"><field name="VALUE">angle</field></block></value><value name="B"><shadow type="math_number" id="$c.).Ali1cyR.xnJ)`BC"><field name="NUM">0</field></shadow></value></block></value><statement name="DO0"><block type="variables_set" id="iz_}v~QPXz|:x$TEEGL0"><field name="VAR" id="O:ETVS!#kKz88JXm`.gR">direction</field><value name="VALUE"><shadow type="math_number" id="FpB**@Ah{11w_WXNnVe2"><field name="NUM">-1</field></shadow></value></block></statement><next><block type="variables_set" id="lsUf4*t`EW]@rD0u78zU"><field name="VAR" id="XU|i8VF~Sv@J?6%[^]{,">rotationTime</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_js_round" id=".UMR*Fl_Hc?Yl)2`nc]t"><field name="OP">round</field><value name="ARG0"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="c!F#Ayy]h^{V0pw~~c!M"><field name="OP">DIVIDE</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="Z!c!2,.d!1-R~S7!bKL$"><field name="VALUE">angle</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="]3L=smS9}*+Ft@G;I4g@"><field name="VAR" id="cD8tiZ{WPEUr^OK=b0XI">ANGULAR_SPD</field></block></value></block></value></block></value><next><block type="ringbitcar_freestyle" id="q!R2Kd|/kWKSP#a|Rxo5"><value name="m"><shadow type="math_number_minmax"><mutation min="-100" max="100"/><field name="SLIDER">0</field></shadow><block type="math_arithmetic" id="x1^@S(yv;Z@iG`bLBtt,"><field name="OP">MULTIPLY</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="$n$d^{^X,!%#y)Lr-:77"><field name="VAR" id="glNF_O=)PhEJN]_YT|2x">LEFT_ROTATION_SPD_MAX</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="(qJ7^h?k+bbwZ0,~IBKf"><field name="VAR" id="O:ETVS!#kKz88JXm`.gR">direction</field></block></value></block></value><value name="n"><shadow type="math_number_minmax"><mutation min="-100" max="100"/><field name="SLIDER">0</field></shadow><block type="math_arithmetic" id=",82Jl(d]%gBIn+.If=jd"><field name="OP">MULTIPLY</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="|O5}Vm20oa2pFm!/65(_"><field name="VAR" id="F4,B#BO%:(iTUsa/n#U)">RIGHT_ROTATION_SPD_MAX</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="9eC^Y.xc=*.6dxJ*ArHe"><field name="VAR" id="O:ETVS!#kKz88JXm`.gR">direction</field></block></value></block></value><next><block type="device_pause" id="X||iSIQAQL6].R5@?vSH"><value name="pause"><shadow type="timePicker"/><block type="variables_get" id="vU_u,fvEvuU.mC0fI9SE"><field name="VAR" id="XU|i8VF~Sv@J?6%[^]{,">rotationTime</field></block></value><next><block type="ringbitcar_brake" id="/jkt-9`ak+~Q35M{%F.I"><next><block type="typescript_statement" id="9K^Fu18N.;|}yGYp!Z5@" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="cHistory.fullCalibration();" numlines="1"></mutation><next><block type="typescript_statement" id="BK.M]4zQN0x,Gsm*tk%^" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let correctionHeading = cHistory.getDelta(1);" numlines="1" declaredvars="correctionHeading"></mutation><next><block type="variables_set" id="Nd-Ca!eMlAU]X$w%-x2G"><field name="VAR" id="EqUr1)Zw!-1vl)BU=Gu7">leftSpeed</field><comment pinned="false" h="80" w="160" relx="10" rely="10">wait for calibration data
turns slowly to finish rotation while calibrating
break</comment><value name="VALUE"><shadow type="math_number" id="vp*9/n@x36KIfyR]r9J6"><field name="NUM">0</field></shadow></value><next><block type="variables_set" id="WNy=UF2c3dbgfbd`|E}x"><field name="VAR" id="=S_s5hviA*1eMKUyoXp*">rightSpeed</field><value name="VALUE"><shadow type="math_number" id=",YtWUv,$v]aF6!~+|umv"><field name="NUM">0</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>